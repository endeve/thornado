# XXX_HOME defines the directory in which all the XXX source code is located
# If you set XXX_HOME as an environment variable, this line will be ignored
AMREX_HOME    ?= $(AMREX_DIR)
THORNADO_HOME ?= $(THORNADO_DIR)
POSEIDON_HOME ?= $(POSEIDON_DIR)
WEAKLIB_HOME  ?= $(WEAKLIB_DIR)
HDF5_HOME     ?= $(HDF5_DIR)
LAPACK_HOME   ?= $(LAPACK_DIR)

HDF5_INC ?= $(HDF5_HOME)/include
HDF5_LIB ?= $(HDF5_HOME)/lib

LAPACK_INC ?= $(LAPACK_HOME)/include
LAPACK_LIB ?= $(LAPACK_HOME)/lib

DEBUG = TRUE

USE_MPI = TRUE
USE_OMP = FALSE

DIM = 1

EBASE = main

INCLUDE_LOCATIONS += $(HDF5_INC)
LIBRARY_LOCATIONS += $(HDF5_LIB)
LIBRARIES += -lhdf5_fortran -lhdf5

INCLUDE_LOCATIONS += $(LAPACK_INC)
LIBRARY_LOCATIONS += $(LAPACK_LIB)
LIBRARIES += -llapack -lblas

# Set pre-processor directives
# This is also where, e.g., USE_HDF5 and USE_PETSC are used
include $(AMREX_HOME)/Tools/GNUMake/Make.defs

# Include basic AMReX framework
include $(AMREX_HOME)/Src/Base/Make.package

ifneq ("$(wildcard $(AMREX_HOME)/Src/DG/Make.package)","")
  # Requires amrex fork from github.com:dunhamsj/amrex
  # Branch: MeshRefinement_DG
  include $(AMREX_HOME)/Src/DG/Make.package
endif

# Include directories and source files needed from amrex
include $(AMREX_HOME)/Src/Boundary/Make.package
include $(AMREX_HOME)/Src/AmrCore/Make.package
include $(AMREX_HOME)/Src/F_Interfaces/Base/Make.package
include $(AMREX_HOME)/Src/F_Interfaces/AmrCore/Make.package

# Include directories and source files needed from thornado
include $(THORNADO_HOME)/SandBox/AMReX/Build/Make.Library_thornado
include $(THORNADO_HOME)/SandBox/AMReX/Build/Make.Numbers_thornado
include $(THORNADO_HOME)/SandBox/AMReX/Build/Make.Units_thornado
include $(THORNADO_HOME)/SandBox/AMReX/Build/Make.EquationOfState_thornado
include $(THORNADO_HOME)/SandBox/AMReX/Build/Make.Fields_thornado
include $(THORNADO_HOME)/SandBox/AMReX/Build/Make.Geometry_thornado
include $(THORNADO_HOME)/SandBox/AMReX/Build/Make.Mesh_thornado
include $(THORNADO_HOME)/SandBox/AMReX/Build/Make.ProgramHeader_thornado
include $(THORNADO_HOME)/SandBox/AMReX/Build/Make.Euler_MR_thornado

include $(THORNADO_HOME)/SandBox/AMReX/Build/Make.Library_amrex
include $(THORNADO_HOME)/SandBox/AMReX/Build/Make.Numbers_amrex
include $(THORNADO_HOME)/SandBox/AMReX/Build/Make.InputOutput_amrex
include $(THORNADO_HOME)/SandBox/AMReX/Build/Make.Fields_amrex
include $(THORNADO_HOME)/SandBox/AMReX/Build/Make.Geometry_amrex
include $(THORNADO_HOME)/SandBox/AMReX/Build/Make.Mesh_amrex
include $(THORNADO_HOME)/SandBox/AMReX/Build/Make.MeshRefinement_amrex
include $(THORNADO_HOME)/SandBox/AMReX/Build/Make.ProgramHeader_amrex
include $(THORNADO_HOME)/SandBox/AMReX/Build/Make.Euler_MR_amrex

include Make.Euler_Relativistic_IDEAL_MR

# Include rules for compilation
include $(AMREX_HOME)/Tools/GNUMake/Make.rules
