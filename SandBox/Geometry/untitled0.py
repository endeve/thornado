
import yt
import numpy as np
import subprocess
from os import listdir
from os.path import isfile
from sys import argv, exit
import matplotlib.pyplot as plt
import math


X=[   3.7499999999999999E-003,
   1.1250000000000000E-002,
   1.8749999999999999E-002,
   2.6249999999999999E-002,
   3.3750000000000002E-002,
   4.1250000000000002E-002,
   4.8750000000000002E-002,
   5.6250000000000001E-002,
   6.3750000000000001E-002,
   7.1250000000000008E-002,
   7.8750000000000014E-002,
   8.6250000000000021E-002,
   9.3750000000000028E-002,
  0.10125000000000003,
  0.10875000000000004,
  0.11625000000000005,
  0.12375000000000005,
  0.13125000000000006,
  0.13875000000000007,
  0.14625000000000007,
  0.15375000000000008,
  0.16125000000000009,
  0.16875000000000009,
  0.17625000000000010,
  0.18375000000000011,
  0.19125000000000011,
  0.19875000000000012,
  0.20625000000000013,
  0.21375000000000013,
  0.22125000000000014,
  0.22875000000000015,
  0.23625000000000015,
  0.24375000000000016,
  0.25125000000000014,
  0.25875000000000015,
  0.26625000000000015,
  0.27375000000000016,
  0.28125000000000017,
  0.28875000000000017,
  0.29625000000000018,
  0.30375000000000019,
  0.31125000000000019,
  0.31875000000000020,
  0.32625000000000021,
  0.33375000000000021,
  0.34125000000000022,
  0.34875000000000023,
  0.35625000000000023,
  0.36375000000000024,
  0.37125000000000025,
  0.37875000000000025,
  0.38625000000000026,
  0.39375000000000027,
  0.40125000000000027,
  0.40875000000000028,
  0.41625000000000029,
  0.42375000000000029,
  0.43125000000000030,
  0.43875000000000031,
  0.44625000000000031,
  0.45375000000000032,
  0.46125000000000033,
  0.46875000000000033,
  0.47625000000000034,
  0.48375000000000035,
  0.49125000000000035,
  0.49875000000000036,
  0.50625000000000031,
  0.51375000000000026,
  0.52125000000000021,
  0.52875000000000016,
  0.53625000000000012,
  0.54375000000000007,
  0.55125000000000002,
  0.55874999999999997,
  0.56624999999999992,
  0.57374999999999987,
  0.58124999999999982,
  0.58874999999999977,
  0.59624999999999972,
  0.60374999999999968,
  0.61124999999999963,
  0.61874999999999958,
  0.62624999999999953,
  0.63374999999999948,
  0.64124999999999943,
  0.64874999999999938,
  0.65624999999999933,
  0.66374999999999929,
  0.67124999999999924,
  0.67874999999999919,
  0.68624999999999914,
  0.69374999999999909,
  0.70124999999999904,
  0.70874999999999899,
  0.71624999999999894,
  0.72374999999999889,
  0.73124999999999885,
  0.73874999999999880,
  0.74624999999999875,
  0.75374999999999870,
  0.76124999999999865,
  0.76874999999999860,
  0.77624999999999855,
  0.78374999999999850,
  0.79124999999999845,
  0.79874999999999841,
  0.80624999999999836,
  0.81374999999999831,
  0.82124999999999826,
  0.82874999999999821,
  0.83624999999999816,
  0.84374999999999811,
  0.85124999999999806,
  0.85874999999999801,
  0.86624999999999797,
  0.87374999999999792,
  0.88124999999999787,
  0.88874999999999782,
  0.89624999999999777,
  0.90374999999999772,
  0.91124999999999767,
  0.91874999999999762,
  0.92624999999999758,
  0.93374999999999753,
  0.94124999999999748,
  0.94874999999999743,
  0.95624999999999738,
  0.96374999999999733,
  0.97124999999999728,
  0.97874999999999723,
  0.98624999999999718,
  0.99374999999999714,
   1.0012499999999971,
   1.0087499999999971,
   1.0162499999999972,
   1.0237499999999973,
   1.0312499999999973,
   1.0387499999999974,
   1.0462499999999975,
   1.0537499999999975,
   1.0612499999999976,
   1.0687499999999976,
   1.0762499999999977,
   1.0837499999999978,
   1.0912499999999978,
   1.0987499999999979,
   1.1062499999999980,
   1.1137499999999980,
   1.1212499999999981,
   1.1287499999999981,
   1.1362499999999982,
   1.1437499999999983,
   1.1512499999999983,
   1.1587499999999984,
   1.1662499999999985,
   1.1737499999999985,
   1.1812499999999986,
   1.1887499999999986,
   1.1962499999999987,
   1.2037499999999988,
   1.2112499999999988,
   1.2187499999999989,
   1.2262499999999990,
   1.2337499999999990,
   1.2412499999999991,
   1.2487499999999991,
   1.2562499999999992,
   1.2637499999999993,
   1.2712499999999993,
   1.2787499999999994,
   1.2862499999999994,
   1.2937499999999995,
   1.3012499999999996,
   1.3087499999999996,
   1.3162499999999997,
   1.3237499999999998,
   1.3312499999999998,
   1.3387499999999999,
   1.3462499999999999,
   1.3537500000000000,
   1.3612500000000001,
   1.3687500000000001,
   1.3762500000000002,
   1.3837500000000003,
   1.3912500000000003,
   1.3987500000000004,
   1.4062500000000004,
   1.4137500000000005,
   1.4212500000000006,
   1.4287500000000006,
   1.4362500000000007,
   1.4437500000000008,
   1.4512500000000008,
   1.4587500000000009,
   1.4662500000000009,
   1.4737500000000010,
   1.4812500000000011,
   1.4887500000000011,
   1.4962500000000012,
   1.5037500000000013,
   1.5112500000000013,
   1.5187500000000014,
   1.5262500000000014,
   1.5337500000000015,
   1.5412500000000016,
   1.5487500000000016,
   1.5562500000000017,
   1.5637500000000017,
   1.5712500000000018,
   1.5787500000000019,
   1.5862500000000019,
   1.5937500000000020,
   1.6012500000000021,
   1.6087500000000021,
   1.6162500000000022,
   1.6237500000000022,
   1.6312500000000023,
   1.6387500000000024,
   1.6462500000000024,
   1.6537500000000025,
   1.6612500000000026,
   1.6687500000000026,
   1.6762500000000027,
   1.6837500000000027,
   1.6912500000000028,
   1.6987500000000029,
   1.7062500000000029,
   1.7137500000000030,
   1.7212500000000031,
   1.7287500000000031,
   1.7362500000000032,
   1.7437500000000032,
   1.7512500000000033,
   1.7587500000000034,
   1.7662500000000034,
   1.7737500000000035,
   1.7812500000000036,
   1.7887500000000036,
   1.7962500000000037,
   1.8037500000000037,
   1.8112500000000038,
   1.8187500000000039,
   1.8262500000000039,
   1.8337500000000040,
   1.8412500000000041,
   1.8487500000000041,
   1.8562500000000042,
   1.8637500000000042,
   1.8712500000000043,
   1.8787500000000044,
   1.8862500000000044,
   1.8937500000000045,
   1.9012500000000045,
   1.9087500000000046,
   1.9162500000000047,
   1.9237500000000047,
   1.9312500000000048,
   1.9387500000000049,
   1.9462500000000049,
   1.9537500000000050,
   1.9612500000000050,
   1.9687500000000051,
   1.9762500000000052,
   1.9837500000000052,
   1.9912500000000053,
   1.9987500000000054,
   2.0062500000000054,
   2.0137500000000053,
   2.0212500000000051,
   2.0287500000000049,
   2.0362500000000048,
   2.0437500000000046,
   2.0512500000000045,
   2.0587500000000043,
   2.0662500000000041,
   2.0737500000000040,
   2.0812500000000038,
   2.0887500000000037,
   2.0962500000000035,
   2.1037500000000033,
   2.1112500000000032,
   2.1187500000000030,
   2.1262500000000029,
   2.1337500000000027,
   2.1412500000000025,
   2.1487500000000024,
   2.1562500000000022,
   2.1637500000000021,
   2.1712500000000019,
   2.1787500000000017,
   2.1862500000000016,
   2.1937500000000014,
   2.2012500000000013,
   2.2087500000000011,
   2.2162500000000009,
   2.2237500000000008,
   2.2312500000000006,
   2.2387500000000005,
   2.2462500000000003,
   2.2537500000000001,
   2.2612500000000000,
   2.2687499999999998,
   2.2762499999999997,
   2.2837499999999995,
   2.2912499999999993,
   2.2987499999999992,
   2.3062499999999990,
   2.3137499999999989,
   2.3212499999999987,
   2.3287499999999985,
   2.3362499999999984,
   2.3437499999999982,
   2.3512499999999981,
   2.3587499999999979,
   2.3662499999999977,
   2.3737499999999976,
   2.3812499999999974,
   2.3887499999999973,
   2.3962499999999971,
   2.4037499999999969,
   2.4112499999999968,
   2.4187499999999966,
   2.4262499999999965,
   2.4337499999999963,
   2.4412499999999961,
   2.4487499999999960,
   2.4562499999999958,
   2.4637499999999957,
   2.4712499999999955,
   2.4787499999999953,
   2.4862499999999952,
   2.4937499999999950,
   2.5012499999999949,
   2.5087499999999947,
   2.5162499999999945,
   2.5237499999999944,
   2.5312499999999942,
   2.5387499999999941,
   2.5462499999999939,
   2.5537499999999937,
   2.5612499999999936,
   2.5687499999999934,
   2.5762499999999933,
   2.5837499999999931,
   2.5912499999999929,
   2.5987499999999928,
   2.6062499999999926,
   2.6137499999999925,
   2.6212499999999923,
   2.6287499999999921,
   2.6362499999999920,
   2.6437499999999918,
   2.6512499999999917,
   2.6587499999999915,
   2.6662499999999913,
   2.6737499999999912,
   2.6812499999999910,
   2.6887499999999909,
   2.6962499999999907,
   2.7037499999999905,
   2.7112499999999904,
   2.7187499999999902,
   2.7262499999999901,
   2.7337499999999899,
   2.7412499999999898,
   2.7487499999999896,
   2.7562499999999894,
   2.7637499999999893,
   2.7712499999999891,
   2.7787499999999890,
   2.7862499999999888,
   2.7937499999999886,
   2.8012499999999885,
   2.8087499999999883,
   2.8162499999999882,
   2.8237499999999880,
   2.8312499999999878,
   2.8387499999999877,
   2.8462499999999875,
   2.8537499999999874,
   2.8612499999999872,
   2.8687499999999870,
   2.8762499999999869,
   2.8837499999999867,
   2.8912499999999866,
   2.8987499999999864,
   2.9062499999999862,
   2.9137499999999861,
   2.9212499999999859,
   2.9287499999999858,
   2.9362499999999856,
   2.9437499999999854,
   2.9512499999999853,
   2.9587499999999851,
   2.9662499999999850,
   2.9737499999999848,
   2.9812499999999846,
   2.9887499999999845,
   2.9962499999999843]



HOME = subprocess.check_output( ["echo $HOME"], shell = True)
HOME = HOME[:-1].decode( "utf-8" ) + '/'

THORNADO_DIR = subprocess.check_output( ["echo $THORNADO_DIR"], shell = True)
THORNADO_DIR = THORNADO_DIR[:-1].decode( "utf-8" ) + '/'

ProblemDirectory = THORNADO_DIR + 'SandBox/AMReX/TwoMoment_Test/'


if( len( argv ) > 1 ):
        File = argv[1]
        
if ( File[-1] == '/' ): File = File[:-1]

ds = yt.load( '{:}'.format( ProblemDirectory + File ) )

print( 'Reading from file: {:}'.format( File ) )
MaxLevel = ds.index.max_level
Time     = ds.current_time
nX       = ds.domain_dimensions
xL       = ds.domain_left_edge
xH       = ds.domain_right_edge

CoveringGrid \
= ds.covering_grid \
          ( level           = MaxLevel, \
           left_edge       = xL, \
           dims            = nX * 2**MaxLevel, \
           num_ghost_zones = nX[0] )

    # XXX.to_ndarray() strips array of yt units

DataUnit = ''

Data = CoveringGrid['PR_D _001_001' ].to_ndarray()
DataI = CoveringGrid['PR_I1_001_001' ].to_ndarray()

np.savetxt("Chi4D.txt", Data, delimiter=',')

np.savetxt("Chi4I.txt", DataI, delimiter=',')

